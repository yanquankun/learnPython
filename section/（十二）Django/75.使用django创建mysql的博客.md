### 本章节继续我们上一课，我们将使用 Django 创建一个 MySQL 数据库的博客系统。

1. 好，首先我们在 files/dg_example 新建一个blog的项目

```bash
python3.10 manage.py startapp blog
```

2. 接下来我们在 blog 目录下创建一个 models.py 文件，并添加以下代码

```python
from django.db import models


class Post(models.Model):
    title = models.CharField(max_length=200)  # 博客标题
    content = models.TextField()  # 博客内容
    created_at = models.DateTimeField(auto_now_add=True)  # 创建时间
    updated_at = models.DateTimeField(auto_now=True)  # 更新时间

    def __str__(self):
        return self.title  # 返回博客标题
```

3. 接下来我们在 blog 目录下创建一个 admin.py 文件，并添加以下代码

```python
from django.contrib import admin

from .models import Post

admin.site.register(Post)  # 注册博客模型到Django管理后台
```

4. 注册应用到 Django 项目中，在 settings.py 文件中添加以下代码

```python
INSTALLED_APPS = [
    # ...
    'blog',  # 注册 blog 应用
]
```

5. 修改 settings.py 文件中的数据库配置，使用 MySQL 数据库

*还记得我们之前的课程讲过的mysql，下面我们将连接自己本地的mysql*

```python
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',  # 使用 MySQL 数据库
        'NAME': 'blog_db',  # 数据库名称
        'USER': 'root',  # MySQL 用户名
        'PASSWORD': 'yqk229218087',  # MySQL 密码
        'HOST': 'localhost',  # MySQL 主机地址
        'PORT': '3306',  # MySQL 端口
    }
}
```

然后安装 MySQL 驱动

```bash
pip3.10 install pymysql
```

确保在 __init__.py 中添加了以下配置，以便 Django 能够正确连接到 MySQL 数据库

```python
import pymysql

pymysql.install_as_MySQLdb()  # 安装 pymysql 作为 MySQL 驱动
```

6. 运行数据库迁移命令，创建数据库表

```sql
CREATE
DATABASE blog_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

```bash
python3.10 manage.py makemigrations
python3.10 manage.py migrate
```

7. 修改时区和语言设置，确保 Django 使用正确的时区和语言

```python
TIME_ZONE = 'Asia/Shanghai'  # 设置时区为上海
LANGUAGE_CODE = 'zh-hans'  # 设置语言为简体中文
```

8. 访问 Django 管理后台，添加博客文章

```bash
python3.10 manage.py createsuperuser  # 创建超级用户
python3.10 manage.py runserver  # 启动开发服务器
```

*这里我创建的账户为admin、密码为admin，生产环境不要这样设置*

访问 http://127.0.1:8000/admin/，使用创建的超级用户登录，添加博客文章。

9. 我们上节课创建了test_app的应用，数据库迁移后，可以在mysql中看到test_app的表结构

![image-20250805143144956](https://oss.yanquankun.cn/oss-cdn/img/image-20250805143144956.png!watermark)

我们在mysql中新增了一条数据，访问 http://127.0.0.1:8000/articles/ 可以看到新增的数据

![image-20250805143308370](https://oss.yanquankun.cn/oss-cdn/img/image-20250805143308370.png!watermark)

![image-20250805143325081](https://oss.yanquankun.cn/oss-cdn/img/image-20250805143325081.png!watermark)

同样，我们在 http://127.0.0.1:8000/admin 管理后台，对blog应用的post表进行增加数据的操作，在mysql中也会进行同步

![image-20250805143446439](https://oss.yanquankun.cn/oss-cdn/img/image-20250805143446439.png!watermark)

![image-20250805143541151](https://oss.yanquankun.cn/oss-cdn/img/image-20250805143541151.png!watermark)

*注意：如果你在使用过程中遇到任何问题，可以参考Django官方文档，或者在网上搜索相关问题的解决方案*

*注意：当你在django中对model进行了修改，*

> 注意
> 
> 如果你在使用过程中遇到任何问题，可以参考Django官方文档，或者在网上搜索相关问题的解决方案
> 
> 中文文档：https://docs.djangoproject.com/zh-hans/4.2/
> 
> 如果你在Django中对模型进行了修改，比如添加了新的字段或者修改了字段类型，你需要重新运行数据库迁移命令来更新数据库结构。

```bash
python3.10 manage.py makemigrations
python3.10 manage.py migrate
```
